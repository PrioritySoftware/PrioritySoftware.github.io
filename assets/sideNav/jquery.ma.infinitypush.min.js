/*!
Off Canvas Infinity Push, a infinity push mobile navigation jQuery plugin.

Version 1.0.0
Full source at https://github.com/marc-andrew/off-canvas-infinity-push
Copyright (c) 2014 Marc Andrew http://marcandrew.net/off-canvas-infinity-push

MIT License (http://www.opensource.org/licenses/mit-license.html)
*/

;(function(e){e.fn.infinitypush=function(t){var n={offcanvas:true,offcanvasspeed:400,offcanvasleft:true,openingspeed:400,closingspeed:400,spacing:90,pushdirectionleft:true,autoScroll:true,scrollSpeed:300,destroy:false};var r=this;var i=e.extend({},n,t);return this.each(function(){function c(){e("."+u).unbind();e("."+f).unbind();e("body").removeClass(l);e("."+n).next().removeAttr("style");e("."+n).find(".ma-infinitypush-inactive").removeClass("ma-infinitypush-inactive");e("."+n).find(".ma-infinitypush-active-item").removeClass("ma-infinitypush-active-item");e("."+n).find(".ma-infinitypush-close-subnav").remove();e("."+n).find("ul").removeAttr("style");r.prependTo(t);r.removeClass("ma-infinitypush ma-infinitypush-sub-open");e("."+n).remove();e(this).removeClass(f);r.stop().removeAttr("style")}var t=e(this).data("oldposition")||e("body"),n="ma-infinitypush-wrapper",s='<div class="'+n+'"></div>',o="ma-infinitypush-active-button",u="ma-infinitypush-button",a='<div class="'+u+'"></div>',f="ma-infinitypush",l="ma-infinitypush-open";if(i.destroy){if(e(this).hasClass(f))c();return}if(!e(this).hasClass(f)){e(this).data("oldposition",e(this).parent());if(!e(this).parent().is("body")){e("body").prepend(e(this))}e(this).before(s).addClass(f).appendTo("."+n);var h=e("."+n).width();if(i.offcanvas==true){e(this).before(a);if(i.offcanvasleft==true){e("."+n).css({left:"-"+h+"px"});e("."+n).addClass("ma-infinitypush-button-left")}else{e("."+n).css({right:"-"+h+"px"});e("."+n).addClass("ma-infinitypush-button-right")}if(i.pushdirectionleft==true){e("."+n).addClass("ma-infinitypush-left")}else{e("."+n).addClass("ma-infinitypush-right")}e("."+n).addClass(o);p()}function p(){e("."+u).on("click",function(){if(e("body").hasClass(l)){d()}else{v()}})}function d(){if(i.offcanvasleft==true){e("."+n).stop().animate({left:"-"+h+"px"},i.offcanvasspeed)}else{e("."+n).stop().animate({right:"-"+h+"px"},i.offcanvasspeed)}e("."+f).stop().animate({opacity:"hide"},i.offcanvasspeed);if(i.offcanvasleft==true){e("."+n).next().stop().animate({left:0},i.offcanvasspeed)}else{e("."+n).next().stop().animate({right:0},i.offcanvasspeed)}e("body").removeClass(l)}function v(){e("body").addClass(l);if(i.offcanvasleft==true){e("."+n).stop().animate({left:0},i.offcanvasspeed)}else{e("."+n).stop().animate({right:0},i.offcanvasspeed)}e("."+f).stop().animate({opacity:"show"},i.offcanvasspeed);if(i.offcanvasleft==true){e("."+n).next().stop().animate({left:h+"px"},i.offcanvasspeed)}else{e("."+n).next().stop().animate({right:h+"px"},i.offcanvasspeed)}m()}function m(){e("."+l).on("mousedown touchstart",function(t){if(e("."+l).length){if(!e("."+n).is(t.target)&&e("."+n).has(t.target).length===0){d()}}})}e("."+f).on("click","a",function(){var t=e(r).width(),n=e(this).parents(r).children("ul"),s=e(this).closest("ul"),o=e(this).parent().find("ul").first(),u="ma-infinitypush-close-subnav",a='<a href="#" class="'+u+'"></a>',l="ma-infinitypush-inactive",c="ma-infinitypush-active-item",h="ma-infinitypush-sub-open";if(n.hasClass(l)&&n.siblings().not(l)){if(s.hasClass(l)){if(i.pushdirectionleft==true){s.find("ul").animate({right:-(t-i.spacing),opacity:"hide"},i.closingspeed)}else{s.find("ul").animate({left:-(t-i.spacing),opacity:"hide"},i.closingspeed)}if(e(this).parent().parent().parent().hasClass(h)){e(r).removeClass(h)}else{s.animate({width:t-i.spacing},i.closingspeed)}s.removeClass(l);s.find("ul").removeClass(l);s.siblings().removeClass(l);s.find("li").removeClass(c);s.find("."+u).animate({opacity:"hide"},i.closingspeed,function(){e(this).remove()});return false}else{if(o.length>0&&!o.is(":visible")){var p=s.scrollTop();e(this).parent().addClass(c);s.addClass(l);if(i.autoScroll==true){if(p>=1){s.animate({scrollTop:0},i.scrollSpeed)}}if(i.autoScroll==true){if(p>=1){e(a).delay(i.scrollSpeed).insertAfter(e(this)).css("display","none").animate({opacity:"show"},i.openingspeed)}else{e(a).insertAfter(e(this)).css("display","none").animate({opacity:"show"},i.openingspeed)}}else{if(p>=1){e(a).insertAfter(e(this)).css({display:"none",top:p}).animate({opacity:"show"},i.openingspeed)}else{e(a).insertAfter(e(this)).css({display:"none",top:0}).animate({opacity:"show"},i.openingspeed)}}if(i.pushdirectionleft==true){if(i.autoScroll==true){if(p>=1){o.delay(i.scrollSpeed).css({right:-(t-i.spacing)}).animate({right:0,opacity:"show",width:t-i.spacing},i.openingspeed)}else{o.css({right:-(t-i.spacing)}).animate({right:0,opacity:"show",width:t-i.spacing},i.openingspeed)}}else{if(p>=1){o.css({right:-(t-i.spacing),top:p}).animate({right:0,opacity:"show",width:t-i.spacing},i.openingspeed)}else{o.css({right:-(t-i.spacing),top:0}).animate({right:0,opacity:"show",width:t-i.spacing},i.openingspeed)}}}else{if(i.autoScroll==true){o.delay(i.scrollSpeed).css({left:-(t-i.spacing)}).animate({left:0,opacity:"show",width:t-i.spacing},i.openingspeed)}else{if(p>=1){o.css({left:-(t-i.spacing),top:p}).animate({left:0,opacity:"show",width:t-i.spacing},i.openingspeed)}else{o.css({left:-(t-i.spacing),top:0}).animate({left:0,opacity:"show",width:t-i.spacing},i.openingspeed)}}}s.animate({width:t},i.openingspeed);return false}}}else{if(o.length>0&&!o.is(":visible")){var p=e("."+f).scrollTop();e(this).parent().addClass(c);s.addClass(l);s.siblings().addClass(l);if(e(r).find("ul").is(":visible")){e(r).addClass(h)}if(i.autoScroll==true){if(p>=1){e("."+f).animate({scrollTop:0},i.scrollSpeed)}}if(i.autoScroll==true){if(p>=1){e(a).delay(i.scrollSpeed).insertAfter(e(this)).css("display","none").animate({opacity:"show"},i.openingspeed)}else{e(a).insertAfter(e(this)).css("display","none").animate({opacity:"show"},i.openingspeed)}}else{if(p>=1){e(a).insertAfter(e(this)).css({display:"none",top:p}).animate({opacity:"show"},i.openingspeed)}else{e(a).insertAfter(e(this)).css({display:"none",top:0}).animate({opacity:"show"},i.openingspeed)}}if(i.pushdirectionleft==true){if(i.autoScroll==true){if(p>=1){o.delay(i.scrollSpeed).css({right:-(t-i.spacing)}).animate({right:0,opacity:"show",width:t-i.spacing},i.openingspeed)}else{o.css({right:-(t-i.spacing)}).animate({right:0,opacity:"show",width:t-i.spacing},i.openingspeed)}}else{if(p>=1){o.css({right:-(t-i.spacing),top:p}).animate({right:0,opacity:"show",width:t-i.spacing},i.openingspeed)}else{o.css({right:-(t-i.spacing),top:0}).animate({right:0,opacity:"show",width:t-i.spacing},i.openingspeed)}}}else{if(i.autoScroll==true){o.delay(i.scrollSpeed).css({left:-(t-i.spacing)}).animate({left:0,opacity:"show",width:t-i.spacing},i.openingspeed)}else{if(p>=1){o.css({left:-(t-i.spacing),top:p}).animate({left:0,opacity:"show",width:t-i.spacing},i.openingspeed)}else{o.css({left:-(t-i.spacing),top:0}).animate({left:0,opacity:"show",width:t-i.spacing},i.openingspeed)}}}return false}}})}})}})(jQuery);


